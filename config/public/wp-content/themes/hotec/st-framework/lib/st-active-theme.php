<?php
if ( is_admin() && isset($_GET['activated'] ) && $pagenow == 'themes.php' ) {
      // your code here
      st_theme_activate();
}

function st_theme_activate() {
   // update_option(ST_SETTINGS_OPTION,$options);
    st_update_default_settings(true);
    ob_start();
  //  header('Location: '.admin_url('admin.php?page='.ST_PAGE_SLUG));
}



/**
 * Update to default settings
 */ 
function  st_update_default_settings($check  = false){
    $option_name = '_'.ST_NAME.'_is_import_default';
    
    if($check === true){
        if(get_option($option_name)=='y'){
              return false;
        }
    }
    
    // default setting options    
    $default ='a:80:{s:15:"page_full_boxed";s:1:"f";s:6:"layout";s:1:"2";s:23:"disable_header_floating";s:1:"n";s:18:"show_footer_widget";s:1:"y";s:9:"site_logo";s:81:"http://demo.smooththemes.com/hotec/wp-content/themes/hotec/assets/images/logo.png";s:12:"site_favicon";s:0:"";s:8:"sidebars";a:5:{i:0;a:2:{s:5:"title";s:7:"Contact";s:2:"id";s:15:"id1363686920866";}i:1;a:2:{s:5:"title";s:3:"Ads";s:2:"id";s:15:"id1366345831849";}i:2;a:2:{s:5:"title";s:12:"Widget Check";s:2:"id";s:15:"id1366514700885";}i:3;a:2:{s:5:"title";s:5:"Rooms";s:2:"id";s:15:"id1366601756671";}i:4;a:2:{s:5:"title";s:7:"Product";s:2:"id";s:15:"id1366619204224";}}s:9:"body_font";a:8:{s:9:"font-size";s:2:"12";s:14:"font-size-unit";s:2:"px";s:11:"line-height";s:2:"22";s:16:"line-height-unit";s:2:"px";s:5:"color";s:6:"666666";s:11:"font-family";s:5:"Arial";s:10:"font-style";s:6:"normal";s:11:"font-weight";s:6:"normal";}s:13:"headings_font";a:1:{s:11:"font-family";s:236:"http://fonts.googleapis.com/css?family=Roboto:100%2C100italic%2C300%2C300italic%2Cregular%2Citalic%2C500%2C500italic%2C700%2C700italic%2C900%2C900italic&subset=latin%2Cgreek-ext%2Cvietnamese%2Clatin-ext%2Cgreek%2Ccyrillic%2Ccyrillic-ext";}s:9:"heading_1";a:2:{s:9:"font-size";s:2:"24";s:14:"font-size-unit";s:2:"px";}s:9:"heading_2";a:2:{s:9:"font-size";s:2:"20";s:14:"font-size-unit";s:2:"px";}s:9:"heading_3";a:2:{s:9:"font-size";s:2:"16";s:14:"font-size-unit";s:2:"px";}s:9:"heading_4";a:2:{s:9:"font-size";s:2:"18";s:14:"font-size-unit";s:2:"px";}s:9:"heading_5";a:2:{s:9:"font-size";s:2:"12";s:14:"font-size-unit";s:2:"px";}s:9:"heading_6";a:2:{s:9:"font-size";s:2:"12";s:14:"font-size-unit";s:2:"px";}s:17:"predefined_colors";s:6:"bca474";s:25:"enable_custom_global_skin";s:1:"n";s:18:"custom_global_skin";s:6:"1f8f34";s:7:"bg_type";s:1:"c";s:10:"defined_bg";s:15:"background1.jpg";s:16:"defined_bg_color";s:6:"f0f0f0";s:8:"bg_color";s:6:"f5f5f5";s:6:"bg_img";s:69:"http://localhost/hotec/wp-content/uploads/2013/04/logo-06-150x150.jpg";s:10:"bg_positon";s:2:"tl";s:10:"bg_repreat";s:1:"y";s:8:"bg_fixed";s:1:"y";s:21:"disable_header_custom";s:1:"y";s:17:"header_link_color";s:6:"202020";s:23:"header_link_hover_color";s:6:"80B500";s:15:"header_bg_color";s:5:"fffff";s:13:"header_bg_img";s:0:"";s:17:"header_bg_positon";s:0:"";s:17:"header_bg_repreat";s:0:"";s:15:"header_bg_fixed";s:0:"";s:14:"titlebar_title";s:0:"";s:13:"titlebar_desc";s:0:"";s:12:"titlebar_img";s:0:"";s:18:"show_blog_toptitle";s:1:"y";s:13:"blog_toptitle";s:9:"New&Pomos";s:18:"show_blog_titlebar";s:1:"y";s:13:"blog_titlebar";s:15:"Some thing here";s:18:"blog_titlebar_desc";s:26:"Some thing about desc here";s:17:"blog_titlebar_img";s:0:"";s:19:"s_show_featured_img";s:1:"y";s:16:"s_show_post_meta";s:1:"y";s:15:"s_show_post_tag";s:1:"y";s:15:"s_show_comments";s:1:"y";s:8:"facebook";s:2:"#f";s:7:"twitter";s:2:"#t";s:11:"google_plus";s:2:"#g";s:7:"youtube";s:2:"#y";s:5:"skype";s:9:"hoangsa2t";s:16:"footer_copyright";s:216:"Copyright &copy; 2013 All Rights Reserved. Powered by <a title=\"WordPress\" href=\"http://wordpress.org\">WordPress</a> and <a title=\"Premium WordPress Themes\" href=\"http://www.smooththemes.com\">SmoothThemes</a>";s:25:"show_head_reservation_btn";s:1:"y";s:20:"reservation_btn_link";s:48:"http://demo.smooththemes.com/hotec/?page_id=1806";s:19:"reservation_btn_txt";s:12:"Reservation ";s:20:"reservation_btn_skin";s:6:"37b6bd";s:27:"reservation_btn_custom_skin";s:1:"n";s:21:"reservation_btn_color";s:6:"139440";s:17:"room_show_res_btn";s:1:"y";s:17:"room_res_btn_link";s:48:"http://demo.smooththemes.com/hotec/?page_id=1806";s:16:"room_res_btn_txt";s:14:"Book this room";s:13:"show_subcribe";s:1:"y";s:15:"feedburner_urli";s:12:"SmoothThemes";s:9:"post_room";s:0:"";s:10:"post_event";s:0:"";s:14:"post_portfolio";s:0:"";s:14:"flex_animation";s:4:"fade";s:17:"flex_directionNav";s:1:"y";s:18:"flex_animationLoop";s:1:"n";s:14:"flex_slideshow";s:1:"n";s:19:"flex_slideshowSpeed";s:4:"7000";s:22:"flex_animationDuration";s:0:"";s:19:"flex_animationSpeed";s:4:"6000";s:18:"flex_pauseOnAction";s:5:"false";s:17:"flex_pauseOnHover";s:1:"n";s:15:"flex_controlNav";s:1:"y";s:14:"flex_randomize";s:1:"n";s:21:"headder_tracking_code";s:0:"";s:20:"footer_tracking_code";s:0:"";}';
    
    $translate  = 'YToxMzk6e3M6MjoiQnkiO3M6MDoiIjtzOjEwOiIlIENvbW1lbnRzIjtzOjA6IiI7czo2OToiVGhpcyBwb3N0IGlzIHBhc3N3b3JkIHByb3RlY3RlZC4gRW50ZXIgdGhlIHBhc3N3b3JkIHRvIHZpZXcgY29tbWVudHMuIjtzOjA6IiI7czoxMjoiTm8gUmVzcG9uc2VzIjtzOjA6IiI7czoxMjoiT25lIFJlc3BvbnNlIjtzOjA6IiI7czoxMToiJSBSZXNwb25zZXMiO3M6MDoiIjtzOjE0OiJPbGRlciBDb21tZW50cyI7czowOiIiO3M6MTQ6Ik5ld2VyIENvbW1lbnRzIjtzOjA6IiI7czoyOiJ0byI7czowOiIiO3M6MjA6IkNvbW1lbnRzIGFyZSBjbG9zZWQuIjtzOjA6IiI7czoxOToiTGVhdmUgYSBSZXBseSB0byAlcyI7czowOiIiO3M6MTE6IllvdSBtdXN0IGJlIjtzOjA6IiI7czoxODoidG8gcG9zdCBhIGNvbW1lbnQuIjtzOjA6IiI7czoyOToiUmVxdWlyZWQgZmllbGRzIGFyZSBtYXJrZWQgJXMiO3M6MDoiIjtzOjEzOiJMZWF2ZSBhIFJlcGx5IjtzOjA6IiI7czoxMjoiQ2FuY2VsIFJlcGx5IjtzOjA6IiI7czoxMjoiUG9zdCBDb21tZW50IjtzOjA6IiI7czo3OiJDb21tZW50IjtzOjA6IiI7czo1NzoiWW91IG11c3QgYmUgPGEgaHJlZj0iJXMiPmxvZ2dlZCBpbjwvYT4gdG8gcG9zdCBhIGNvbW1lbnQuIjtzOjA6IiI7czo0MToiWW91ciBlbWFpbCBhZGRyZXNzIHdpbGwgbm90IGJlIHB1Ymxpc2hlZC4iO3M6MDoiIjtzOjQ6Ik5hbWUiO3M6MDoiIjtzOjU6IkVtYWlsIjtzOjA6IiI7czo3OiJXZWJzaXRlIjtzOjA6IiI7czo3OiJUd2l0dGVyIjtzOjA6IiI7czo4OiJGYWNlYm9vayI7czowOiIiO3M6MTE6Ikdvb2dsZSBQbHVzIjtzOjA6IiI7czoxMjoiU3RheSBDb25uZWN0IjtzOjA6IiI7czo1OiJTa3lwZSI7czowOiIiO3M6MTU6Ik1haW4gTmF2aWdhdGlvbiI7czowOiIiO3M6NjoiU2VhcmNoIjtzOjA6IiI7czo3OiJQYWdlICVzIjtzOjA6IiI7czoxNToiUGVybWFsaW5rIHRvICVzIjtzOjA6IiI7czoxMToiVmlldyBEZXRhaWwiO3M6MDoiIjtzOjExOiJPcGVuIERldGFpbCI7czowOiIiO3M6MTI6Ik9wZW4gR2FsbGVyeSI7czowOiIiO3M6MzoiQWxsIjtzOjA6IiI7czoyOiLDlyI7czowOiIiO3M6MjoiYXQiO3M6MDoiIjtzOjE0OiJUb3RhbCAlcyBwaG90byI7czowOiIiO3M6MTU6IlRvdGFsICVzIHBob3RvcyI7czowOiIiO3M6MTg6IkludmFsaWQgUmVjaXBpZW50cyI7czowOiIiO3M6MTg6IkludmFsaWQgeW91ciBFbWFpbCI7czowOiIiO3M6ODoiTmFtZTogJXMiO3M6MDoiIjtzOjExOiJBZGRyZXNzOiAlcyI7czowOiIiO3M6OToiRW1haWw6ICVzIjtzOjA6IiI7czoyNToiUmVzZXJ2YXRpb24gUm9vbSBUeXBlOiAlcyI7czowOiIiO3M6MTc6Ik5vLiBvZiBhZHVsdHM6ICVzIjtzOjA6IiI7czoxOToiTm8uIG9mIGNoaWxkcmVuOiAlcyI7czowOiIiO3M6MTY6IkFycml2YWwgRGF0ZTogJXMiO3M6MDoiIjtzOjE4OiJEZXBhcnR1cmUgRGF0ZTogJXMiO3M6MDoiIjtzOjE2OiJQaG9uZSBOdW1iZXI6ICVzIjtzOjA6IiI7czozMjoiU3BlY2lhbCBSZXF1aXJlbWVudHM6IDxiciAvPiAlcyAiO3M6MDoiIjtzOjM0OiJZb3UgaGF2ZSBhIG5ldyByZXNlcnZhdGlvbiBmcm9tICVzIjtzOjA6IiI7czozNToiWW91IGhhdmUgYSBuZXcgcmVzZXJ2YXRpb24gcmVxdWVzdCEiO3M6MDoiIjtzOjE4OiJDYW4gbm90IHNlbmQgbWFpbC4iO3M6MDoiIjtzOjEwOiJFbWFpbDogICVzIjtzOjA6IiI7czoxMToiU3ViamVjdDogJXMiO3M6MDoiIjtzOjExOiJNZXNzYWdlOiAlcyI7czowOiIiO3M6Mjg6IllvdSBoYXZlIGEgbmV3IGVtYWlsIGZyb20gJXMiO3M6MDoiIjtzOjIzOiJZb3UgaGF2ZSBhIG5ldyBtZXNzYWdlISI7czowOiIiO3M6OToiMCBDb21tZW50IjtzOjA6IiI7czo5OiIxIENvbW1lbnQiO3M6MDoiIjtzOjk6IlVzZXJuYW1lOiI7czowOiIiO3M6MjU6IkhvdyBtYW55IGl0ZW1zIHRvIHNob3cgPyAiO3M6MDoiIjtzOjg6IlN1YmNyaWJlIjtzOjA6IiI7czo0OiJSb29tIjtzOjA6IiI7czo1OiJSb29tcyI7czowOiIiO3M6NDoiVGFncyI7czowOiIiO3M6MzoiVGFnIjtzOjA6IiI7czo4OiJBbGwgVGFncyI7czowOiIiO3M6MTI6IlBvcHVsYXIgVGFncyI7czowOiIiO3M6ODoiQ2F0ZWdvcnkiO3M6MDoiIjtzOjEwOiJDYXRlZ29yaWVzIjtzOjA6IiI7aTo0MDQ7czowOiIiO3M6MjQ6IkdvIGJhY2sgdG8gcHJldmlvdXMgcGFnZSI7czowOiIiO3M6MTQ6IkdvIHRvIGhvbWVwYWdlIjtzOjA6IiI7czo2OiJQYWdlczoiO3M6MDoiIjtzOjk6Ik5leHQgcGFnZSI7czowOiIiO3M6MTM6IlByZXZpb3VzIHBhZ2UiO3M6MDoiIjtzOjU6IlRhZ3M6IjtzOjA6IiI7czoxNToiUHJvamVjdCBEZXRhaWxzIjtzOjA6IiI7czo2OiJDbGllbnQiO3M6MDoiIjtzOjY6IlNraWxscyI7czowOiIiO3M6NToiVmlzaXQiO3M6MDoiIjtzOjI2OiJQcm9qZWN0IFNob3J0IERlY3NjcmlwdGlvbiI7czowOiIiO3M6MjA6IlByb2plY3QgRGVjc2NyaXB0aW9uIjtzOjA6IiI7czoxNjoiUmVsYXRlZCBQcm9qZWN0cyI7czowOiIiO3M6MTc6IlNlcnZpY2VzIEluY2x1ZGVkIjtzOjA6IiI7czo5OiJDYXRlZ29yeToiO3M6MDoiIjtzOjExOiJSZXNlcnZhdGlvbiI7czowOiIiO3M6MTE6IlNlYWNoIGZvciA6IjtzOjA6IiI7czoxODoiRGFpbHkgQXJjaGl2ZXM6ICVzIjtzOjA6IiI7czoyMDoiTW9udGhseSBBcmNoaXZlczogJXMiO3M6MDoiIjtzOjE5OiJZZWFybHkgQXJjaGl2ZXM6ICVzIjtzOjA6IiI7czoxMzoiQmxvZyBBcmNoaXZlcyI7czowOiIiO3M6MTQ6IkJvb2sgdGhpcyByb29tIjtzOjA6IiI7czo5OiJZb3VyIE5hbWUiO3M6MDoiIjtzOjg6InJlcXVpcmVkIjtzOjA6IiI7czoxNzoiWW91ciBQaG9uZSBOdW1iZXIiO3M6MDoiIjtzOjE5OiJZb3VyIEUtTWFpbCBBZGRyZXNzIjtzOjA6IiI7czo3OiJTdWJqZWN0IjtzOjA6IiI7czo4OiJNZXNzYWdlOiI7czowOiIiO3M6MTA6IlN1Ym1pdCBOb3ciO3M6MDoiIjtzOjEwOiJZb3VyIE5hbWU6IjtzOjA6IiI7czoxOToiWW91ciBlbWFpbCBhZGRyZXNzOiI7czowOiIiO3M6MTc6IkNob29zZSByb29tIHR5cGU6IjtzOjA6IiI7czoxMzoiU2VsZWN0IGEgcm9vbSI7czowOiIiO3M6MTI6IkZhbWlseSBTdWl0ZSI7czowOiIiO3M6MTQ6Ik5vLiBvZiBhZHVsdHM6IjtzOjA6IiI7czoxMzoiQXJyaXZhbCBEYXRlOiI7czowOiIiO3M6MTM6IllvdXIgQWRkcmVzczoiO3M6MDoiIjtzOjE4OiJZb3VyIHBob25lIG51bWJlcjoiO3M6MDoiIjtzOjEzOiJOby4gb2Ygcm9vbXM6IjtzOjA6IiI7czoxNjoiTm8uIG9mIGNoaWxkcmVuOiI7czowOiIiO3M6MTU6IkRlcGFydHVyZSBEYXRlOiI7czowOiIiO3M6MjE6IlNwZWNpYWwgUmVxdWlyZW1lbnRzOiI7czowOiIiO3M6MzQ6IlNpZ24gdXAgdG8gcmVjZWl2ZSBTcGVjaWFsIE9mZmVyczoiO3M6MDoiIjtzOjI1OiJFbnRlciB5b3VyIGUtbWFpbCBhZGRyZXNzIjtzOjA6IiI7czo5OiJTdWJzY3JpYmUiO3M6MDoiIjtzOjE3OiJWaWV3IEV2ZW50IERldGFpbCI7czowOiIiO3M6MTM6IkZpbmQgT3V0IE1vcmUiO3M6MDoiIjtzOjE3OiJSYXRlZCAlcyBvdXQgb2YgNSI7czowOiIiO3M6NzoiUmV2aWV3cyI7czowOiIiO3M6NDI6IjxzcGFuIGNsYXNzPSJtZXRhLW5hdiI+4oaQPC9zcGFuPiBQcmV2aW91cyI7czowOiIiO3M6Mzg6Ik5leHQgPHNwYW4gY2xhc3M9Im1ldGEtbmF2Ij7ihpI8L3NwYW4+IjtzOjA6IiI7czoxNToiQWRkIFlvdXIgUmV2aWV3IjtzOjA6IiI7czoxMDoiQWRkIFJldmlldyI7czowOiIiO3M6MTI6IkFkZCBhIHJldmlldyI7czowOiIiO3M6MTM6IlN1Ym1pdCBSZXZpZXciO3M6MDoiIjtzOjk6IlJlYWQgTW9yZSI7czowOiIiO3M6MTQ6IlNlbGVjdCBvcHRpb25zIjtzOjA6IiI7czoxMjoiVmlldyBvcHRpb25zIjtzOjA6IiI7czoyMjoiU2hvd2luZyBhbGwgJWQgcmVzdWx0cyI7czowOiIiO3M6MzU6IlNob3dpbmcgJTEkZOKAkyUyJGQgb2YgJTMkZCByZXN1bHRzIjtzOjA6IiI7czoxNzoiVXNlcm5hbWUgb3IgZW1haWwiO3M6MDoiIjtzOjg6IlBhc3N3b3JkIjtzOjA6IiI7czozMzoiWW91ciBjb21tZW50IGlzIGF3YWl0aW5nIGFwcHJvdmFsIjtzOjA6IiI7czo5NzoiTG9nZ2VkIGluIGFzIDxhIGhyZWY9IiUxJHMiPiUyJHM8L2E+LiA8YSBocmVmPSIlMyRzIiB0aXRsZT0iTG9nIG91dCBvZiB0aGlzIGFjY291bnQiPkxvZyBvdXQ/PC9hPiI7czowOiIiO3M6MTkxOiJXZSdyZSBzb3JyeSwgYnV0IHdlIGNhbid0IGZpbmQgdGhlIHBhZ2UgeW91IHdlcmUgbG9va2luZyBmb3IuIEl0J3MgcHJvYmFibHkgc29tZSB0aGluZyB3ZSd2ZSBkb25lIHdyb25nIGJ1dCBub3cgd2Uga25vdyBhYm91dCBpdCB3ZSdsbCB0cnkgdG8gZml4IGl0LiBJbiB0aGUgbWVhbnRpbWUsIHRyeSBvbmUgb2YgdGhpcyBvcHRpb25zOiI7czowOiIiO30=';
    
    $default = maybe_unserialize($default);
    $default['site_logo'] = st_img('logo.png');
    update_option(ST_SETTINGS_OPTION,$default);
    
    if(st_is_wpml()){
        $langs = icl_get_languages('skip_missing=0&orderby=KEY&order=asc');
        foreach($langs as $l){
           update_option(ST_SETTINGS_OPTION.'_'.$l['language_code'],$default);
        }
    }
    // update translate options
    update_option(ST_TRANSLATE_OPTION, unserialize(base64_decode($translate)));
    
    update_option($option_name,'y');
    
}


/* Flush rewrite rules for custom post types. */
add_action( 'after_switch_theme', 'flush_rewrite_rules' );



